<!DOCTYPE html>
<html lang="pt">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Um convite especial</title>
		<style>
			/* Vari√°vel CSS para a altura da viewport */
			:root {
				--vh: 1vh;
			}

			body {
				font-family: Arial, sans-serif;
				margin: 0;
				background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
				overflow: hidden; /* Remova se n√£o for necess√°ria */
				position: relative;
				height: calc(var(--vh, 1vh) * 100); /* Use a vari√°vel --vh */
				color: white;
				text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
			}

			#fireworks {
				position: fixed;
				width: 100%;
				height: 100%;
				top: 0;
				left: 0;
				pointer-events: none;
				z-index: 1;
			}

			/* Match Animation Styles */
			.match-container {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: calc(var(--vh, 1vh) * 100); /* Use a vari√°vel --vh */
				display: flex;
				flex-direction: column;
				justify-content: center;
				align-items: center;
				background: rgba(0, 0, 0, 0.9);
				z-index: 1000;
				opacity: 1;
				transition: opacity 0.5s ease;
				gap: 30px; /* Espa√ßamento entre os elementos */
			}

			.avatars-container {
				display: flex;
				justify-content: center;
				align-items: center;
				gap: 20px;
			}

			.avatar {
				width: 120px;
				height: 120px;
				border-radius: 50%;
				border: 3px solid white;
				object-fit: cover;
				opacity: 0;
				transform: translateX(-100px);
			}

			.avatar:last-child {
				transform: translateX(100px);
			}

			.match-text {
				font-size: 3rem;
				font-weight: bold;
				color: white;
				opacity: 0;
				transform: scale(0.5);
				text-align: center;
			}

			/* Centralizar conte√∫do */
			.match-content {
				display: flex;
				flex-direction: column;
				justify-content: center;
				align-items: center;
				gap: 30px; /* Espa√ßamento entre avatares e texto */
			}

			/* Avatar Animation */
			@keyframes slideInLeft {
				to {
					opacity: 1;
					transform: translateX(0);
				}
			}

			@keyframes slideInRight {
				to {
					opacity: 1;
					transform: translateX(0);
				}
			}

			@keyframes matchPop {
				0% {
					opacity: 0;
					transform: scale(0.5);
				}
				70% {
					opacity: 1;
					transform: scale(1.2);
				}
				100% {
					opacity: 1;
					transform: scale(1);
				}
			}

			@keyframes fadeOutMatch {
				to {
					opacity: 0;
				}
			}

			/* Modified Slides Container for horizontal scrolling */
			.slides-container {
				height: calc(var(--vh, 1vh) * 100); /* Use a vari√°vel --vh */
				overflow: hidden;
				position: relative;
				opacity: 0;
				transition: opacity 1s ease;
				z-index: 2;
			}

			.slide {
				height: calc(var(--vh, 1vh) * 100); /* Use a vari√°vel --vh */
				display: flex;
				justify-content: center;
				align-items: center;
				position: absolute;
				width: 100%;
				transition: transform 0.5s cubic-bezier(0.23, 1, 0.32, 1);
			}

			.slide-content {
				font-size: 2rem;
				text-align: center;
				padding: 20px;
				max-width: 80%;
			}

			/* Modified progress bar styles */
			.progress-container {
				position: fixed;
				top: 20px;
				left: 0;
				right: 0;
				display: flex;
				gap: 4px;
				padding: 0 16px;
				z-index: 5;
			}

			.progress-bar {
				flex: 1;
				height: 2px;
				background: rgba(255, 255, 255, 0.3);
				border-radius: 2px;
				overflow: hidden;
			}

			.progress-bar-fill {
				height: 100%;
				background: white;
				width: 0%;
				transition: width linear;
			}

			/* Modified navigation for horizontal scroll */
			.navigation-overlay {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				display: flex;
				z-index: 4;
			}

			.nav-area {
				width: 50%;
				height: 100%;
				cursor: pointer;
				-webkit-tap-highlight-color: transparent;
			}

			/* Removendo estilos antigos de scroll */
			.swipe-indicator {
				display: none;
			}

			/* Ajustando slide-indicators para stories */
			.slide-indicators {
				display: none;
			}

			/* Estilos refinados para a se√ß√£o final */
			.final-section {
				display: none;
				height: calc(var(--vh, 1vh) * 100); /* Use a vari√°vel --vh */
				justify-content: center;
				align-items: center;
				flex-direction: column;
				padding: 20px;
				text-align: center;
				z-index: 2;
				position: relative;
				background: linear-gradient(
					135deg,
					rgba(255, 154, 158, 0.8) 0%,
					rgba(250, 208, 196, 0.8) 100%
				);
			}

			.final-content {
				opacity: 0;
				transform: scale(0.5);
				animation: popIn 1s forwards;
				background: rgba(255, 255, 255, 0.1);
				backdrop-filter: blur(10px);
				padding: 2.5rem;
				border-radius: 20px;
				box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
				border: 1px solid rgba(255, 255, 255, 0.2);
				max-width: 90%;
				width: 400px;
			}

			@keyframes popIn {
				0% {
					opacity: 0;
					transform: scale(0.5) translateY(50px);
				}
				50% {
					transform: scale(1.1) translateY(-10px);
				}
				75% {
					transform: scale(0.95) translateY(5px);
				}
				100% {
					opacity: 1;
					transform: scale(1) translateY(0);
				}
			}

			.question {
				font-size: 2.5rem;
				color: white;
				margin-bottom: 2rem;
				font-weight: bold;
				text-align: center;
				text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
				animation: pulseText 2s infinite;
			}

			@keyframes pulseText {
				0%,
				100% {
					transform: scale(1);
				}
				50% {
					transform: scale(1.05);
				}
			}

			.buttons {
				display: flex;
				flex-direction: column;
				gap: 1.5rem;
				width: 100%;
				margin-top: 2rem;
			}

			button {
				padding: 15px 30px;
				font-size: 1.2rem;
				border: none;
				border-radius: 25px;
				cursor: pointer;
				transition: all 0.3s ease;
				width: 100%;
				transform-origin: center;
				font-weight: bold;
				letter-spacing: 1px;
			}

			#btnSim {
				background: linear-gradient(45deg, #4caf50, #45a049);
				color: white;
				box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);
				animation: pulse 2s infinite;
			}

			#btnSim:hover {
				transform: scale(1.05);
				box-shadow: 0 6px 20px rgba(76, 175, 80, 0.6);
			}

			#btnNao {
				background: linear-gradient(45deg, #f44336, #da190b);
				color: white;
				box-shadow: 0 4px 15px rgba(244, 67, 54, 0.4);
				transition: all 0.3s ease;
			}

			#btnNao:hover {
				transform: scale(0.95);
				box-shadow: 0 2px 10px rgba(244, 67, 54, 0.3);
			}

			@keyframes pulse {
				0% {
					transform: scale(1);
					box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);
				}
				50% {
					transform: scale(1.05);
					box-shadow: 0 8px 25px rgba(76, 175, 80, 0.6);
				}
				100% {
					transform: scale(1);
					box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);
				}
			}

			/* Estilos para feedback visual ao tocar */
			.nav-area:active {
				background: transparent;
			}

			/* Media Query para dispositivos com largura m√°xima de 600px */
			@media (max-width: 600px) {
				.final-content {
					width: auto; /* Remove a largura fixa */
					max-width: 90%; /* Mant√©m a largura m√°xima em 90% da tela */
					margin: 0 20px; /* Adiciona uma margem de 20px √† esquerda e √† direita */
					padding: 2rem; /* Ajusta o padding se necess√°rio */
				}
			}

			/* Media Query adicional para telas muito pequenas (opcional) */
			@media (max-width: 400px) {
				.final-content {
					margin: 0 10px; /* Margem menor para telas muito pequenas */
					padding: 1.5rem; /* Reduz o padding se necess√°rio */
				}
			}
		</style>
		<!-- Script para definir a vari√°vel --vh -->
		<script>
			function setVh() {
				let vh = window.innerHeight * 0.01;
				document.documentElement.style.setProperty('--vh', `${vh}px`);
			}

			// Inicializa a vari√°vel --vh quando a p√°gina √© carregada
			window.addEventListener('load', setVh);
			// Atualiza a vari√°vel --vh quando a janela √© redimensionada
			window.addEventListener('resize', setVh);
		</script>
	</head>
	<body>
		<!-- Match Animation Container -->
		<div class="match-container">
			<!-- Centralizar conte√∫do -->
			<div class="match-content">
				<div class="avatars-container">
					<!-- Substitua os src abaixo pelos URLs reais das imagens dos avatares -->
					<img
						src="https://i.imgur.com/AtO9jy3.jpeg"
						alt="Avatar 1"
						class="avatar"
					/>
					<img
						src="https://i.imgur.com/b8v2wXg.jpeg"
						alt="Avatar 2"
						class="avatar"
					/>
				</div>
				<div class="match-text">IT'S A MATCH! üëÄ</div>
			</div>
		</div>

		<div id="fireworks"></div>

		<div class="slides-container">
			<!-- Progress bars ser√£o inseridas aqui via JavaScript -->
			<div class="progress-container"></div>

			<!-- √Åreas de navega√ß√£o -->
			<div class="navigation-overlay">
				<div class="nav-area" id="prevArea"></div>
				<div class="nav-area" id="nextArea"></div>
			</div>
		</div>

		<div class="final-section">
			<!-- O conte√∫do final ser√° inserido dinamicamente via JavaScript -->
		</div>

		<!-- Biblioteca Fireworks JS -->
		<script src="https://cdn.jsdelivr.net/npm/fireworks-js/dist/fireworks.js"></script>
		<script>
			document.addEventListener('DOMContentLoaded', () => {
				// Sele√ß√£o dos elementos principais
				const matchContainer = document.querySelector('.match-container');
				const avatars = document.querySelectorAll('.avatar');
				const matchText = document.querySelector('.match-text');
				const slidesContainer = document.querySelector('.slides-container');
				const progressContainer = document.querySelector('.progress-container');
				const finalSection = document.querySelector('.final-section');

				// Anima√ß√£o de entrada dos avatares
				avatars[0].style.animation = 'slideInLeft 0.8s forwards';
				avatars[1].style.animation = 'slideInRight 0.8s forwards';

				// Anima√ß√£o do texto "IT'S A MATCH!"
				setTimeout(() => {
					matchText.style.animation = 'matchPop 0.5s forwards';
				}, 800);

				// Ap√≥s a anima√ß√£o, fade out e exibi√ß√£o dos slides
				setTimeout(() => {
					matchContainer.style.animation = 'fadeOutMatch 0.5s forwards';
					setTimeout(() => {
						matchContainer.style.display = 'none';
						slidesContainer.style.opacity = '1';
						initializeSlides(); // Inicializa os slides ap√≥s a anima√ß√£o
					}, 500);
				}, 2500); // Tempo total da anima√ß√£o de match

				// Fun√ß√£o para calcular a diferen√ßa de tempo
				function getTimeDifference() {
					// Defina a data de in√≠cio aqui (18 de agosto √†s 8h48)
					const startDate = new Date('August 18, 2024 08:48:00');
					const now = new Date();

					// Calcula a diferen√ßa em milissegundos
					let diffInMs = now - startDate;

					// Calcula os dias, horas e minutos
					const diffInSeconds = Math.floor(diffInMs / 1000);
					const days = Math.floor(diffInSeconds / (3600 * 24));
					let remainingSeconds = diffInSeconds % (3600 * 24);
					const hours = Math.floor(remainingSeconds / 3600);
					remainingSeconds %= 3600;
					const minutes = Math.floor(remainingSeconds / 60);

					return `<br>${days} dias, ${hours} horas e ${minutes} minutos <br> para ser mais exato`;
				}

				// Fun√ß√£o para inicializar os slides
				function initializeSlides() {
					const STORY_DURATION = 5000; // 5 segundos por hist√≥ria
					const timePassed = getTimeDifference(); // Obt√©m o tempo decorrido

					const textos = [
						'"Toda desprevenida portanto ü§£"',
						'Foi assim que tudo come√ßou a 18 de agosto',
						'De facto j√° se passou algum tempo',
						timePassed, // Adiciona a frase din√¢mica aqui
						'E sei que falhei contigo üôÑ',
						'E acredita, que estou mesmo arrependido üòû',
						'Mas tudo acontece por um motivo...',
						'E de pressa e bem h√° pouco quem',
						'Foram precisos 3 anos para come√ßarmos a falar',
						'E agora que come√ßamos, n√£o sei se faz muito sentido deixar',
						'Enquanto houver 1% de chance...',
						'Vou tentar a minha sorte üëÄ',
						'E se calhar isto at√© √© demais',
						'Mas ao menos estou a tentar',
						'Sei que ficou muito por fazer...',
						'E por dizer...',
						'Ainda n√£o comemos os crepes ü•û',
						'Nem a picanha...',
						'N√£o vimos Elemental üî•üöø',
						'Nem fizemos a sess√£o de fotos',
						'E mais importante...',
						'Ainda n√£o me ensinaste as tuas receitas',
						'Sem esquecer do pain au chocolat, claro!',
						'E sei que ainda ficou muito mais por fazer...',
						'Que se quiseres eu quero fazer contigo',
						'√âs mesmo especial, e sei que errei contigo',
						'E por isso Adriana...',
					];

					// Criar slides
					textos.forEach((texto, index) => {
						const slide = document.createElement('div');
						slide.className = 'slide';
						slide.innerHTML = `
                        <div class="slide-content">
                            ${texto}
                        </div>
                    `;
						slide.style.transform = `translateX(${index * 100}%)`;
						slidesContainer.appendChild(slide);
					});

					// Criar barras de progresso
					textos.forEach((_, index) => {
						const progressBar = document.createElement('div');
						progressBar.className = 'progress-bar';
						progressBar.innerHTML = '<div class="progress-bar-fill"></div>';
						progressContainer.appendChild(progressBar);
					});

					let currentSlide = 0;
					const slides = document.querySelectorAll('.slide');
					let isAnimating = false;
					let finalSectionShown = false;
					let storyTimeout;

					// Fun√ß√µes atualizadas

					function updateProgressBars(instant = false) {
						const progressBars =
							document.querySelectorAll('.progress-bar-fill');

						progressBars.forEach((bar, index) => {
							// Reset all transitions and styles first
							bar.style.transition = 'none';
							bar.style.width = '0%';

							// Force reflow to ensure styles are applied
							bar.offsetHeight;

							if (index < currentSlide) {
								// Previous slides - fully filled
								bar.style.width = '100%';
							} else if (index === currentSlide) {
								// Current slide
								if (!instant) {
									bar.style.transition = `width linear ${
										STORY_DURATION / 1000
									}s`;
									requestAnimationFrame(() => {
										bar.style.width = '100%';
									});
								}
							}
							// Slides after current remain at 0%
						});
					}

					function showPrevSlide() {
						if (currentSlide <= 0 || isAnimating) return;

						isAnimating = true;
						currentSlide--;

						// Update slide positions
						slides.forEach((slide, index) => {
							slide.style.transform = `translateX(${
								(index - currentSlide) * 100
							}%)`;
						});

						// Clear existing timer and reset progress bars
						clearTimeout(storyTimeout);

						// Reset e iniciar novo timer com progress bars
						updateProgressBars(false);
						startStoryTimer();

						setTimeout(() => {
							isAnimating = false;
						}, 500);
					}

					function showNextSlide() {
						if (currentSlide >= slides.length - 1 || isAnimating) return;

						isAnimating = true;
						currentSlide++;

						// Update slide positions
						slides.forEach((slide, index) => {
							slide.style.transform = `translateX(${
								(index - currentSlide) * 100
							}%)`;
						});

						// Clear existing timer e reset progress bars
						clearTimeout(storyTimeout);

						// Reset e iniciar novo timer com progress bars
						updateProgressBars(false);
						startStoryTimer();

						setTimeout(() => {
							isAnimating = false;
						}, 500);
					}

					function startStoryTimer() {
						// Clear any existing timeout
						clearTimeout(storyTimeout);

						// Set new timeout
						storyTimeout = setTimeout(() => {
							if (currentSlide < slides.length - 1) {
								showNextSlide();
							} else {
								showFinalSection();
							}
						}, STORY_DURATION);
					}

					// Atualizar progress bar e timer
					requestAnimationFrame(() => {
						updateProgressBars(false);
						startStoryTimer();
					});

					function showFinalSection() {
						if (finalSectionShown) return; // Se a se√ß√£o final j√° foi exibida, n√£o faz nada
						finalSectionShown = true; // Define a flag para evitar futuras execu√ß√µes

						slidesContainer.style.display = 'none';
						finalSection.style.display = 'flex';
						const indicators = document.querySelector('.slide-indicators');
						if (indicators) indicators.style.display = 'none';

						// Criar e animar o conte√∫do final
						const finalContent = document.createElement('div');
						finalContent.className = 'final-content';
						finalContent.innerHTML = `
                        <div class="question">Ser√° que isto vale mais uma chance? ü§î<br /></div>
                        <div class="buttons">
                            <button id="btnSim">Sim üëÄ</button>
                            <button id="btnNao">N√£o</button>
                        </div>
                    `;
						finalSection.appendChild(finalContent);

						// Recriar event listeners para os bot√µes
						initializeButtons();
					}

					// Configurar navega√ß√£o por clique nas √°reas
					const nextArea = document.getElementById('nextArea');
					const prevArea = document.getElementById('prevArea');

					nextArea.addEventListener('click', () => {
						if (currentSlide < slides.length - 1) {
							showNextSlide();
						} else {
							showFinalSection();
						}
					});
					prevArea.addEventListener('click', showPrevSlide);

					// *** Integra√ß√£o do Novo C√≥digo de Eventos de Toque ***
					// Vari√°veis para manipula√ß√£o de toque
					let touchStartX = 0;
					let touchStartY = 0;
					let touchEndX = 0;
					let touchEndY = 0;

					slidesContainer.addEventListener('touchstart', (e) => {
						touchStartX = e.touches[0].clientX;
						touchStartY = e.touches[0].clientY;
						clearTimeout(storyTimeout); // Pausa o timer da hist√≥ria enquanto est√° tocando
					});

					slidesContainer.addEventListener(
						'touchmove',
						(e) => {
							touchEndX = e.touches[0].clientX;
							touchEndY = e.touches[0].clientY;

							// Previne o scroll padr√£o quando o gesto √© predominantemente horizontal
							const diffX = Math.abs(touchEndX - touchStartX);
							const diffY = Math.abs(touchEndY - touchStartY);

							if (diffX > diffY) {
								e.preventDefault();
							}
						},
						{passive: false}
					);

					slidesContainer.addEventListener('touchend', (e) => {
						touchEndX = e.changedTouches[0].clientX;
						touchEndY = e.changedTouches[0].clientY;

						const diffX = touchStartX - touchEndX;
						const diffY = Math.abs(touchEndY - touchStartY);

						// Verifica se o gesto foi mais horizontal do que vertical e se a movimenta√ß√£o foi significativa
						const minSwipeDistance = 50; // Dist√¢ncia m√≠nima para considerar um swipe

						if (Math.abs(diffX) > diffY && Math.abs(diffX) > minSwipeDistance) {
							if (diffX > 0) {
								// Swipe para a esquerda - vai para o pr√≥ximo slide
								if (currentSlide < slides.length - 1) {
									showNextSlide();
								} else {
									showFinalSection();
								}
							} else {
								// Swipe para a direita - vai para o slide anterior
								showPrevSlide();
							}
						} else {
							// Se n√£o for um swipe claro, retoma o timer
							startStoryTimer();
						}
					});

					// Pausar hist√≥rias quando a aba n√£o estiver vis√≠vel
					document.addEventListener('visibilitychange', () => {
						if (document.hidden) {
							clearTimeout(storyTimeout);
						} else {
							startStoryTimer();
						}
					});
				}

				// Fun√ß√£o para criar o voucher
				function createVoucher() {
					const voucherContent = `
===============================
VALE ENCONTRO NO "SEI L√Å"
===============================
Data: ${new Date().toLocaleDateString()}
Hora: 19:00
Local: Sei L√°
===============================
V√°lido para: Um encontro especial
==============================
                `;

					const blob = new Blob([voucherContent], {type: 'text/plain'});
					const url = window.URL.createObjectURL(blob);
					const a = document.createElement('a');
					a.href = url;
					a.download = 'vale_encontro.txt';
					a.click();
					window.URL.revokeObjectURL(url);
				}

				// Fun√ß√£o para inicializar os event listeners dos bot√µes na se√ß√£o final
				function initializeButtons() {
					const naoButton = document.getElementById('btnNao');
					let scale = 1;
					let clickCount = 0;
					const messages = [
						'Tens a certeza? ü§®',
						'Mesmo a certeza? üòü',
						'Pensa s√≥ mais um bocadinho... ü§î',
						'Vaaaaaa l√°√°√°√°√°! üòÖ',
						'S√≥ mais uma chance! üôè',
						'De certeza? ü•∫',
						'N√£o sejas assim... üò¢',
						'üò¢',
					];

					naoButton.addEventListener('click', () => {
						if (clickCount < messages.length) {
							naoButton.textContent = messages[clickCount];
							scale *= 0.8;
							naoButton.style.transform = `scale(${scale})`;
							clickCount++;
						}
					});

					const btnSim = document.getElementById('btnSim');
					btnSim.addEventListener('click', () => {
						if (typeof Fireworks === 'undefined') {
							console.error('Fireworks n√£o est√° definido.');
							return;
						}

						const container = document.getElementById('fireworks');
						const fireworksInstance = new Fireworks(container, {
							speed: 2,
							acceleration: 1.05,
							friction: 0.98,
							gravity: 1.5,
							particles: 50,
							trace: 3,
							explosion: 5,
							autoresize: true,
							brightness: {
								min: 50,
								max: 80,
							},
							decay: {
								min: 0.015,
								max: 0.03,
							},
							boundaries: {
								x: 50,
								y: 50,
							},
							sound: {
								enable: false,
							},
						});
						fireworksInstance.start();

						setTimeout(() => {
							fireworksInstance.stop();
						}, 5000);

						// Atualizar o conte√∫do final com nova mensagem e bot√£o surpresa
						finalSection.innerHTML = `
                        <div class="final-content">
                            <div class="question">Vamooos! </div>
                            <p style="font-size: 1.5rem; color: white; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);">Prometo que n√£o te vais arrepender! üòá</p>
                            <p style="font-size: 1.5rem; color: white; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);">Vemo-nos no Sei L√°? üëÄ</p>
                            <button id="surpriseBtn" >Mais uma coisa üéÅ</button>
                        </div>
                    `;

						// Adicionar event listener para o bot√£o surpresa
						document
							.getElementById('surpriseBtn')
							.addEventListener('click', createVoucher);
					});
				}
			});
		</script>
	</body>
</html>
